//
//  FileManager.m
//  Symmetry
//
//  Created by John on 19/05/2014.
//  Copyright (c) 2014 jgrindall. All rights reserved.
//

#import "FacebookService.h"
#import "AppDelegate.h"
#import "ToastUtils.h"
#import <Social/Social.h>
#import <MessageUI/MessageUI.h>
#import <MessageUI/MFMailComposeViewController.h>

@interface FacebookService ()

@end

@implementation FacebookService

NSString* const BASE64 = @"data:image/png;base64,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";

+ (id)sharedInstance {
    static FacebookService* service = nil;
    static dispatch_once_t onceToken;
    dispatch_once(&onceToken, ^{
        service = [[self alloc] init];
    });
    return service;
}

- (UIImage*) getScreenshot{
	UIImage* screengrab;
	CGRect screenRect = [[UIScreen mainScreen] bounds];
	UIGraphicsBeginImageContext(screenRect.size);
	CGContextRef ctx = UIGraphicsGetCurrentContext();
	[[UIColor blackColor] set];
	CGContextFillRect(ctx, screenRect);
	UIWindow* window = [UIApplication sharedApplication].keyWindow;
	[window.layer renderInContext:ctx];
	screengrab = UIGraphicsGetImageFromCurrentImageContext();
	UIGraphicsEndImageContext();
	return screengrab;
}

- (NSString*) getUrl{
	return @"http://bit.ly/1UaC5LH";
}

- (NSString*) getMessageFb{
	return @"Check out what I made learning to code with Logotacular. #logotacular";
}

- (NSString*) getMessageTwitter{
	NSString* text = @"Look what I made learning to code with Logotacular! #logotacular";
	return [NSString stringWithFormat:@"%@ %@", text, [self getUrl]];
}

- (UIViewController*) getViewController{
	AppDelegate* del = (AppDelegate *)[UIApplication sharedApplication].delegate;
	return del.window.rootViewController;
}

- (void) postToSocialNetwork:(UIImage*)img withText:(NSString*) text withCallback:(void(^)(FacebookResults result))callback withServiceType:(NSString *)serviceType{
	UIViewController* presenter = [self getViewController];
	if(!presenter){
		return;
	}
	if([SLComposeViewController isAvailableForServiceType:serviceType]) {
        SLComposeViewController* controller = [SLComposeViewController composeViewControllerForServiceType:serviceType];
        [controller setInitialText:text];
        [controller addURL:[NSURL URLWithString:[self getUrl]]];
        [controller addImage:img];
		[controller setCompletionHandler:^(SLComposeViewControllerResult result) {
			if(result == SLComposeViewControllerResultCancelled){
				callback(FacebookResultCancelled);
			}
			else if(result == SLComposeViewControllerResultDone){
				callback(FacebookResultOk);
			}
		}];
        [presenter presentViewController:controller animated:YES completion:nil];
	}
	else{
		callback(FacebookResultNoFacebook);
	}
}

- (void) postImageToTwitter:(UIImage*)img withCallback:(void(^)(FacebookResults result))callback{
	[self postToSocialNetwork:img withText:[self getMessageTwitter] withCallback:callback withServiceType:SLServiceTypeTwitter];
}

- (void) postImageToFacebook:(UIImage*)img withCallback:(void(^)(FacebookResults result))callback{
	[self postToSocialNetwork:img withText:[self getMessageFb] withCallback:callback withServiceType:SLServiceTypeFacebook];
}

- (void) email:(UIImage*)screengrab{
	if([MFMailComposeViewController canSendMail]) {
		UIViewController* presenter = [self getViewController];
		if(!presenter){
			return;
		}
		NSData* jpegData = UIImageJPEGRepresentation(screengrab, 1.0);
		MFMailComposeViewController *mailCont = [[MFMailComposeViewController alloc] init];
		mailCont.mailComposeDelegate = self;
		[mailCont setSubject:@"Check out what I made using Logotacular"];
		NSString* fileName = @"logotacular";
		fileName = [fileName stringByAppendingPathExtension:@"jpeg"];
		[mailCont addAttachmentData:jpegData mimeType:@"image/jpeg" fileName:fileName];
		NSString* url = [self getUrl];
		NSString* body = [NSString stringWithFormat:@"<html><body><p>I've been using the <a href='%@'>Logotacular app</a> to learn about coding - check out what I've done!</p><p><a href='%@'><img src='%@'></img></a></p></body></html>", url, url, BASE64];
		[mailCont setMessageBody:body isHTML:YES];
		[presenter presentViewController:mailCont animated:YES completion:nil];
	}
}

- (void)mailComposeController:(MFMailComposeViewController*)controller didFinishWithResult:(MFMailComposeResult)result error:(NSError*)error {
	[controller dismissViewControllerAnimated:YES completion:nil];
}

@end

